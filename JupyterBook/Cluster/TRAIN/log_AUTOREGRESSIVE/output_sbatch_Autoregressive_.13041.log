environment: line 10: __conda_exe: command not found
# conda environments:
#
torch_env             *  /home/DAVIDSON/alalkadhim.visitor/.conda/envs/torch_env
base                     /home/DAVIDSON/alalkadhim.visitor/software/miniconda3

using torch version 1.12.1
matplotlib version=  3.5.1
using (optional) optuna version 3.0.0
BASE directoy properly set =  /home/DAVIDSON/alalkadhim.visitor/IQN/DAVIDSON_NEW/DEC_19

BASE directory not properly set. Read repo README.    If you need a function from utils, use the decorator below, or add utils to sys.path

    You can also do 
    os.environ['IQN_BASE']=<ABSOLUTE PATH FOR THE IQN REPO>
    or
    os.environ['IQN_BASE']=os.getcwd()
using torch version 1.12.1
matplotlib version=  3.5.1
using (optional) optuna version 3.0.0
BASE directoy properly set =  /home/DAVIDSON/alalkadhim.visitor/IQN/DAVIDSON_NEW/DEC_19

BASE directory not properly set. Read repo README.    If you need a function from utils, use the decorator below, or add utils to sys.path

    You can also do 
    os.environ['IQN_BASE']=<ABSOLUTE PATH FOR THE IQN REPO>
    or
    os.environ['IQN_BASE']=os.getcwd()
using DATA_DIR=/home/DAVIDSON/alalkadhim.visitor/IQN/DAVIDSON_NEW/data
SUBSAMPLE = None

 RAW TRAIN DATA

(8000000, 9)

 RAW TEST DATA

(1000000, 9)

 RAW TRAIN DATA

(8000000, 9)

 RAW TEST DATA

(1000000, 9)
{'genDatapT': {'mean': 32.695234084987476, 'std': 14.937932540562551}, 'genDataeta': {'mean': -0.0017818817154031672, 'std': 2.204309760627079}, 'genDataphi': {'mean': -0.0003830903308450233, 'std': 1.8138251604791067}, 'genDatam': {'mean': 6.962994352358474, 'std': 2.781332025286383}, 'RecoDatapT': {'mean': 32.86720151648752, 'std': 15.829355769531851}, 'RecoDataeta': {'mean': -0.0017898858568513964, 'std': 2.197968491495457}, 'RecoDataphi': {'mean': -0.0004719170328962474, 'std': 1.8144739820043825}, 'RecoDatam': {'mean': 5.555567451922438, 'std': 2.664339857066051}, 'tau': None}



{'genDatapT': {'mean': 32.6654809616, 'std': 14.746663776411731}, 'genDataeta': {'mean': 0.002821766734118711, 'std': 2.2025132218012735}, 'genDataphi': {'mean': -0.0005116820324618385, 'std': 1.8141583811877282}, 'genDatam': {'mean': 6.957271011526192, 'std': 2.765752894623606}, 'RecoDatapT': {'mean': 32.8490938466, 'std': 15.617172793936655}, 'RecoDataeta': {'mean': 0.0028149588128446, 'std': 2.196165457846061}, 'RecoDataphi': {'mean': -0.0005495613684869987, 'std': 1.8146982567744574}, 'RecoDatam': {'mean': 5.554066938043617, 'std': 2.644892802850232}, 'tau': None}
SCALED TRAIN DATA
TRAINING FEATURES
    genDatapT  RecoDatapT  genDataeta  ...  genDatam  RecoDatam       tau
0   3.382531    3.463020    0.828187  ...  1.579696   1.525158  0.361310
1   3.191270    3.308764   -1.163510  ...  2.058837   1.995432  0.126899
2   3.191270    3.308764   -1.163510  ...  2.058837   1.995432  0.962307
3   3.191270    3.308764   -1.163510  ...  2.058837   1.995432  0.457282
4   3.004211    3.187005    1.844410  ...  2.040038   1.886115  0.840862

[5 rows x 9 columns]

TESTING FEATURES
    genDatapT  RecoDatapT  genDataeta  ...  genDatam  RecoDatam       tau
0   3.775316    3.791603    0.824891  ...  2.071044   2.054470  0.250046
1   3.775316    3.791603    0.824891  ...  2.071044   2.054470  0.847493
2   3.258685    3.313277    3.529970  ...  2.242060   1.918984  0.851995
3   3.349708    3.522816   -1.159650  ...  2.286615   2.204338  0.052378
4   3.090315    3.149058    2.747660  ...  1.971738   1.805105  0.542549

[5 rows x 9 columns]

train set shape: (8000000, 9)

test set shape:   (1000000, 9)
Training Features:
 ['RecoDatam', 'RecodatapT', 'RecoDataeta', 'genDatapT', 'genDataeta', 'genDataphi', 'genDatam', 'tau']

Target =  RecoDataphi
USING NEW DATASET

spliting data for RecoDataphi
Traceback (most recent call last):
  File "/home/DAVIDSON/alalkadhim.visitor/IQN/DAVIDSON_NEW/DEC_19/TRAIN/Trainphi.py", line 399, in <module>
    train_t_ratio, train_x = split_t_x(df= train_data_m, target = target, input_features=features)
  File "/home/DAVIDSON/alalkadhim.visitor/IQN/DAVIDSON_NEW/DEC_19/TRAIN/Trainphi.py", line 394, in split_t_x
    x = np.array(df[input_features])
  File "/home/DAVIDSON/alalkadhim.visitor/.conda/envs/torch_env/lib/python3.10/site-packages/pandas/core/frame.py", line 3511, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "/home/DAVIDSON/alalkadhim.visitor/.conda/envs/torch_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 5782, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/DAVIDSON/alalkadhim.visitor/.conda/envs/torch_env/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 5845, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['RecodatapT'] not in index"
srun: error: phy4kuchera: task 0: Exited with exit code 1
